#!/bin/sh

# various config files
find "$HOME/.files" -maxdepth 1 -type f -iname ".*" -exec ln -fs {} "$HOME" \;
ln -fP "$HOME/.files/conf/.makepkg.conf" "$HOME"

# lock before suspend
sudo cp "$HOME/.files/conf/suspend@.service" /etc/systemd/system
systemctl enable "suspend@$(whoami)"

# redshift locale config
cp "$HOME/.files/conf/redshift.conf" "$HOME/.config"
curl -s -N "https://ipinfo.io/geo"                                          \
  | awk -F\" '/loc/ {split($4, x, ","); print "lat=" x[1] "\nlon=" x[2]}'   \
  >> "$HOME/.config/redshift.conf"

# journald options
sudo sed -E -i 's/#St/St/; s/auto/volatile/; s/#C/C/; s/#(R.*Use=)/\164M/'  \
  /etc/systemd/journald.conf

# keyboard settings
localectl --no-convert set-keymap us-acentos

# private key that is used during authentication will be added to ssh-agent
echo "AddKeysToAgent yes" | sudo tee -a /etc/ssh/ssh_config > /dev/null

# disable ARP probing
echo "noarp" | sudo tee -a /etc/dhcpcd.conf > /dev/null
